<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Goplug by swarvanusg</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Goplug</h1>
        <h2>GoPlug:  A Go Library to Create and Manage Plugin with Dynamic Loading</h2>
        <a href="https://github.com/swarvanusg/GoPlug" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="goplug" class="anchor" href="#goplug" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>GoPlug</h1>

<pre><code>&lt; GoPlug &gt;
 --------
   \
    \   
       _____  -----------------  _____
      |     \/  ----     ----  \/     |
       \  ==/  /    |   |    \  \==  /
        \--/  | ()  |   |()   |  \--/
          /    \---/ ___ \---/    \
         |         _(===)_         |
        |         (__/--\__)        |
         |          |_||_|         |
          \                       /   
</code></pre>

<p>GoPlug is a pure Go Plugin library project that provides flexibility, Loose Coupling and modeler approach of Building Software in/around Go. The goal of the project is to provide a simple, fast and a reliable plugin architecture that is independent of the platform. </p>

<p><a href="https://godoc.org/github.com/swarvanusg/GoPlug">GpPlug GoDoc</a></p>

<h3>
<a id="version" class="anchor" href="#version" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Version</h3>

<p>0.1.0</p>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h3>

<h4>
<a id="step-1--get-it" class="anchor" href="#step-1--get-it" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Step 1 : Get It</h4>

<p>To get the GoPlug install Go and execute the below command </p>

<pre><code>go get github.com/swarvanusg/GoPlug
</code></pre>

<h4>
<a id="step-2-life-cycle" class="anchor" href="#step-2-life-cycle" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Step 2: Life-cycle</h4>

<p>GoPlug plugin life-cycle is quite simple as it consist only three state. 
1. <strong>Stopped</strong> : Plugin is not yet started or stopped
2. <strong>Discovered/Installed</strong> : Plugin is discovered and ready to be started
3. <strong>Started/Loaded</strong> : Plugin is started or Loaded for serving request</p>

<h6>
<a id="plugin-registry" class="anchor" href="#plugin-registry" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin Registry</h6>

<p>Each of the application creates a Plugin Registry to manage Plugins. Plugin Registry is based on plugin discovery service that provide API to search, load and unload plugin to/from registry.</p>

<p>Auto discovery service at plugin registry could be disabled resulting plugin to be discovered at loading time.</p>

<h6>
<a id="plugin" class="anchor" href="#plugin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin</h6>

<p>Each plugin makes itself available for the discovery service, and while discovered it is loaded by the application. On a successful loading start() is called and on a successful uploading stop() is called</p>

<p>Lazy start could be enabled to make plugin loaded by explicit call to Plugin Registry rather than at discovery. </p>

<h4>
<a id="step-3-use-it" class="anchor" href="#step-3-use-it" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Step 3: Use it</h4>

<h5>
<a id="plugin-conf" class="anchor" href="#plugin-conf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin Conf</h5>

<hr>

<p>Plugin conf (.pconf) defines the plugin properties. It is created by the Plugins at Plugin startup and loaded by the Application. </p>

<h6>
<a id="examplepconf" class="anchor" href="#examplepconf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example.pconf</h6>

<div class="highlight highlight-source-json"><pre>    {
        <span class="pl-s"><span class="pl-pds">"</span>Name<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>NameOfPlugin<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>NameSpace<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>NamespaceOfPlugin<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>Url<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>unix://PluginUrl<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>sock<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>unixSockLocation.sock<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>LazyLoad<span class="pl-pds">"</span></span> : <span class="pl-c1">false</span>,
    }</pre></div>

<h5>
<a id="application-that-use-plugins" class="anchor" href="#application-that-use-plugins" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Application That Use Plugins</h5>

<hr>

<p>Plugin registry is initialized with the plugin location where it will search for plugin conf <strong>(.pconf)</strong>, along with the Auto Discover setting. If auto discovery is enabled the discover service starts and search for new plugin, while in other case of discovery service not running, plugin gets discovered while loading (via Explicit call to LoadPlugin) if available.</p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">plugRegConf</span> <span class="pl-k">:=</span> <span class="pl-v">GoPlug</span>.<span class="pl-smi">PluginRegConf</span>{PluginLocation: <span class="pl-s"><span class="pl-pds">"</span>./PluginLoc<span class="pl-pds">"</span></span>, <span class="pl-v">AutoDiscover</span>: <span class="pl-c1">true</span>}
    <span class="pl-c">/* Initialize a Plugin Registry that will search location "./PluginLoc" for '.pconf' file */</span>  
    <span class="pl-smi">pluginReg</span>, <span class="pl-smi">err</span> <span class="pl-k">:=</span> <span class="pl-v">GoPlug</span>.<span class="pl-c1">PluginRegInit</span>(plugRegConf)</pre></div>

<p>Lazyload is a feature that prevents auto loading of a plugin when it is discovered. If Plugin is Configured for lazy load plugin should be loaded explicitly when needed by the user.  </p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">plugin</span>, <span class="pl-smi">err</span> <span class="pl-k">:=</span> pluginReg.<span class="pl-c1">LoadPlugin</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>namespace<span class="pl-pds">"</span></span>)</pre></div>

<p>Each plugin is identified by the plugin name and namespace</p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">plugin</span> <span class="pl-k">:=</span> pluginReg.<span class="pl-c1">GetPlugin</span>(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>namespace<span class="pl-pds">"</span></span>)</pre></div>

<p>Plugin can be searched for available methods (registered methods by Plugin implementation)</p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">methodList</span> <span class="pl-k">:=</span> plugin.<span class="pl-c1">GetMethods</span>()</pre></div>

<p>Method could be executed by method name </p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">returnBytes</span>, <span class="pl-smi">err</span> <span class="pl-k">:=</span> plugin.<span class="pl-c1">Execute</span>(methodName, inputBytes)</pre></div>

<p>Callback could be registered in Application to receive notification from plugin</p>

<div class="highlight highlight-source-go"><pre>    plugin.<span class="pl-c1">RegisterCallback</span>(Foo)
    ...
    <span class="pl-k">func</span> <span class="pl-en">Foo</span>(<span class="pl-v">data</span> []<span class="pl-v">byte</span>) {
        <span class="pl-c">// Callback body called on notification from pugin</span>
    }</pre></div>

<p>Plugin could be forced to unload or stopped</p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">err</span> <span class="pl-k">:=</span> pluginReg.<span class="pl-c1">UnloadPlugin</span>(plugin)</pre></div>

<h5>
<a id="plugin-implementation" class="anchor" href="#plugin-implementation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plugin Implementation</h5>

<hr>

<p>Plugin is initialized with the <strong>Location</strong>, <strong>Name</strong>, <strong>Namespace</strong> (optional), <strong>Url</strong> (optional), <strong>LazyStart conf</strong>, <strong>Activator</strong> and <strong>Stopper</strong>. 
The Plugin location should be same on which Plugin Registry is configured</p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-smi">config</span> <span class="pl-k">:=</span> <span class="pl-v">GoPlug</span>.<span class="pl-smi">PluginImplConf</span>{<span class="pl-s"><span class="pl-pds">"</span>PluginLoc<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Namespace<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>unix://URL<span class="pl-pds">"</span></span>, <span class="pl-c1">false</span>, activate, stop}
    <span class="pl-smi">plugin</span>, <span class="pl-smi">err</span> <span class="pl-k">:=</span> <span class="pl-v">GoPlug</span>.<span class="pl-c1">PluginInit</span>(config)
    ...
    <span class="pl-k">func</span> <span class="pl-en">activate</span>(<span class="pl-v">input</span> []<span class="pl-v">byte</span>) []<span class="pl-v">byte</span> {
        <span class="pl-c">// Called on Activation of the Plugin</span>
    }
    <span class="pl-k">func</span> <span class="pl-en">stop</span>(<span class="pl-v">input</span> []<span class="pl-v">byte</span>) []<span class="pl-v">byte</span> {
        <span class="pl-c">// Called on Deactivation of the Plugin</span>
    }</pre></div>

<p>Method should be registered before starting the plugin</p>

<div class="highlight highlight-source-go"><pre>plugin.<span class="pl-c1">RegisterMethod</span>(Do)
...
<span class="pl-k">func</span> <span class="pl-en">Do</span>(<span class="pl-v">input</span> []<span class="pl-v">byte</span>) []<span class="pl-v">byte</span> {
    <span class="pl-c">// Call on execution of "Do" from application</span>
}</pre></div>

<p>Plugin start makes the plugin available for the discovery service and to be loaded</p>

<div class="highlight highlight-source-go"><pre>plugin.<span class="pl-c1">Start</span>()</pre></div>

<p>Plugin could notify application using callback. A list of registered callbacks are available at plugins</p>

<div class="highlight highlight-source-go"><pre>    <span class="pl-c">//get available callback list</span>
    <span class="pl-smi">callbackList</span> <span class="pl-k">:=</span> plugin.<span class="pl-c1">GetCallbacks</span>()
    ...
    <span class="pl-smi">err</span> <span class="pl-k">:=</span> plugin.<span class="pl-c1">Notify</span>(callbackName, inputBytes)</pre></div>

<p>Plugin stop makes the plugin to be stopped and unavailable from the Plugin Reg service. It should be done after plugin is unloaded from the Plugin registry. </p>

<div class="highlight highlight-source-go"><pre>plugin.<span class="pl-c1">stop</span>()</pre></div>

<p><a href="https://godoc.org/github.com/swarvanusg/GoPlug#pkg-index">More ...</a></p>

<h4>
<a id="step-4-how-it-works" class="anchor" href="#step-4-how-it-works" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Step 4: How It Works</h4>

<p>Plugins runs a different process that sould be started explicitly. Unix domain socket is used for IPC where the communication is based on HTTP request response model. </p>

<h6>
<a id="step-by-step" class="anchor" href="#step-by-step" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Step by Step:</h6>

<ol>
<li>At start of the Plugin it opens a Unix domain socket and listen for connection</li>
<li>Once it initialized it puts the .pconf file in a specific location of Plugin Discovery</li>
<li>Plugin Registry discover the .pconf and load the configuration to get the properties and UNIX sock</li>
<li>Plugin Registry initialize the Connections using UNIX sock and it loads the Plugin information </li>
<li>Http request is made as per the methods Executed over the connection</li>
</ol>

<h3>
<a id="current-status" class="anchor" href="#current-status" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Current Status</h3>

<p>GoPlug is unstable and in active development and testing</p>

<h3>
<a id="future-scope" class="anchor" href="#future-scope" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Future Scope</h3>

<p>As GoPlug Plugin are independent process and the communication is based on Unix socket and Http. Plugin could be developed using any programming language. In future GoPlug Plugin Implementation library should be implemented in different languages.  </p>

<h3>
<a id="more-information" class="anchor" href="#more-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>More Information</h3>

<p>This is an early release. I’ve been using it for a while and this is working fine. I like this one pretty well, but no guarantees
that it won’t change a bit. </p>

<p>For Any more info Contact:</p>

<pre><code>swarvanusg@gmail.com
</code></pre>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/swarvanusg/GoPlug/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/swarvanusg/GoPlug/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/swarvanusg/GoPlug"></a> is maintained by <a href="https://github.com/swarvanusg">swarvanusg</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
